<Window x:Class="MyJiraTickets.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MyJiraTickets"
        mc:Ignorable="d"
        Title="MyJiraTickets - Jira Ticket Manager" Height="600" Width="1000" MinHeight="400" MinWidth="800" WindowState="Normal">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>  <!-- Menu -->
            <RowDefinition Height="Auto"/>  <!-- Jira URL -->
            <RowDefinition Height="Auto"/>  <!-- Ticket Name -->
            <RowDefinition Height="Auto"/>  <!-- Status -->
            <RowDefinition Height="Auto"/>  <!-- Type -->
            <RowDefinition Height="Auto"/>  <!-- Priority -->
            <RowDefinition Height="Auto"/>  <!-- Buttons -->
            <RowDefinition Height="Auto"/>  <!-- Progress Bar -->
            <RowDefinition Height="Auto"/>  <!-- Status Message -->
            <RowDefinition Height="*"/>     <!-- Ticket List -->
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*"/>
            <ColumnDefinition Width="Auto"/>
        </Grid.ColumnDefinitions>

        <Menu Grid.Row="0" Grid.ColumnSpan="2">
            <MenuItem Header="Settings" Click="Settings_Click"/>
        </Menu>

        <TextBlock Grid.Row="1" Grid.Column="0" Text="Jira Ticket URL:" VerticalAlignment="Center"/>
        <StackPanel Grid.Row="1" Grid.Column="1" Orientation="Horizontal" Margin="5">
            <TextBox x:Name="JiraUrlBox" Width="250" Margin="0,0,8,0" LostFocus="JiraUrlBox_LostFocus" KeyDown="JiraUrlBox_KeyDown"/>
            <CheckBox x:Name="ManualModeBox" Content="Manual" VerticalAlignment="Center" Checked="ManualModeBox_Changed" Unchecked="ManualModeBox_Changed"/>
        </StackPanel>

        <TextBlock Grid.Row="2" Grid.Column="0" Text="Ticket Name:" VerticalAlignment="Center"/>
    <TextBox x:Name="TicketNameBox" Grid.Row="2" Grid.Column="1" Width="350" Margin="5" IsReadOnly="True"/>

        <TextBlock Grid.Row="3" Grid.Column="0" Text="Status:" VerticalAlignment="Center"/>
        <StackPanel Grid.Row="3" Grid.Column="1" Orientation="Horizontal" Margin="5">
            <ComboBox x:Name="StatusBox" Width="200" Height="25" SelectionChanged="StatusBox_SelectionChanged">
                <ComboBoxItem Content="To Do"/>
                <ComboBoxItem Content="Refinement"/>
                <ComboBoxItem Content="In Progress"/>
                <ComboBoxItem Content="Waiting for Deploy"/>
                <ComboBoxItem Content="In Test"/>
                <ComboBoxItem Content="Test Succeeded"/>
                <ComboBoxItem Content="Test Failed"/>
                <ComboBoxItem Content="Done"/>
                <ComboBoxItem Content="Canceled"/>
                <ComboBoxItem Content="On Hold"/>
            </ComboBox>
            <Button x:Name="AddTicketBtn" Content="Add Ticket" Click="AddTicket_Click" Width="110" Height="28" Margin="10,0,0,0" IsEnabled="False"/>
        </StackPanel>

        <TextBlock Grid.Row="4" Grid.Column="0" Text="Type:" VerticalAlignment="Center"/>
        <StackPanel Grid.Row="4" Grid.Column="1" Orientation="Horizontal" Margin="5">
            <ComboBox x:Name="TypeBox" Width="200" Height="25" SelectionChanged="TypeBox_SelectionChanged">
                <ComboBoxItem Content="Task"/>
                <ComboBoxItem Content="Bug"/>
                <ComboBoxItem Content="Story"/>
                <ComboBoxItem Content="Epic"/>
                <ComboBoxItem Content="Subtask"/>
            </ComboBox>
        </StackPanel>

        <TextBlock Grid.Row="5" Grid.Column="0" Text="Priority:" VerticalAlignment="Center"/>
        <StackPanel Grid.Row="5" Grid.Column="1" Orientation="Horizontal" Margin="5">
            <ComboBox x:Name="PriorityBox" Width="200" Height="25" SelectionChanged="PriorityBox_SelectionChanged">
                <ComboBoxItem Content="Highest"/>
                <ComboBoxItem Content="High"/>
                <ComboBoxItem Content="Medium"/>
                <ComboBoxItem Content="Low"/>
                <ComboBoxItem Content="Lowest"/>
            </ComboBox>
        </StackPanel>

        <StackPanel Grid.Row="6" Grid.ColumnSpan="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,10,0,25">
            <Button x:Name="DeleteSelectedBtn" Content="Delete Selected" Click="DeleteSelectedTicket_Click" Width="130" Height="28" Margin="0,0,8,0" IsEnabled="False"/>
            <Button Content="Generate start.html" Click="GenerateHtml_Click" Width="160" Height="28" Margin="0,0,8,0"/>
            <Button x:Name="LoadAllTicketsBtn" Content="Load All Jira Tickets" Click="LoadAllTickets_Click" Width="150" Height="28" Margin="0,0,8,0"/>
        </StackPanel>

        <!-- Progress Bar for bulk operations -->
        <StackPanel Grid.Row="7" Grid.ColumnSpan="2" Orientation="Horizontal" Margin="0,5,0,5" x:Name="ProgressPanel" Visibility="Collapsed">
            <TextBlock Text="Loading tickets: " VerticalAlignment="Center" Margin="0,0,10,0"/>
            <ProgressBar x:Name="LoadingProgressBar" Width="200" Height="20" VerticalAlignment="Center" Margin="0,0,10,0"/>
            <TextBlock x:Name="ProgressText" Text="0/0" VerticalAlignment="Center"/>
        </StackPanel>

        <!-- Status Message -->
        <TextBlock x:Name="StatusMessage" Grid.Row="8" Grid.ColumnSpan="2" 
                   Text="Ready" Foreground="Green" FontWeight="Bold" 
                   HorizontalAlignment="Left" Margin="0,5,0,5"/>

    <DataGrid x:Name="TicketsList" Grid.Row="9" Grid.ColumnSpan="2" Margin="0,10,0,0" 
              AutoGenerateColumns="False" CanUserAddRows="False" CanUserDeleteRows="False"
              HeadersVisibility="Column" GridLinesVisibility="Horizontal"
              HorizontalGridLinesBrush="LightGray" VerticalGridLinesBrush="Transparent"
              SelectionMode="Single" SelectionChanged="TicketsList_SelectionChanged"
              KeyDown="TicketsList_KeyDown" CellEditEnding="TicketsList_CellEditEnding">
        <DataGrid.Columns>
            <DataGridTemplateColumn Header="" Width="40">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <Button Content="🔗" Width="30" Height="24" Tag="{Binding Url}" Click="OpenTicket_Click"/>
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
            </DataGridTemplateColumn>
            
            <DataGridTextColumn Header="Issue" Binding="{Binding Key}" Width="100" IsReadOnly="True">
                <DataGridTextColumn.ElementStyle>
                    <Style TargetType="TextBlock">
                        <Setter Property="FontWeight" Value="Bold"/>
                        <Setter Property="VerticalAlignment" Value="Center"/>
                    </Style>
                </DataGridTextColumn.ElementStyle>
            </DataGridTextColumn>
            
            <DataGridTextColumn Header="Summary" Binding="{Binding Summary}" Width="*" IsReadOnly="True">
                <DataGridTextColumn.ElementStyle>
                    <Style TargetType="TextBlock">
                        <Setter Property="TextTrimming" Value="CharacterEllipsis"/>
                        <Setter Property="VerticalAlignment" Value="Center"/>
                    </Style>
                </DataGridTextColumn.ElementStyle>
            </DataGridTextColumn>
            
            <DataGridTemplateColumn Header="Status" Width="180">
                <DataGridTemplateColumn.CellTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding Status}" VerticalAlignment="Center" Padding="4">
                            <TextBlock.Style>
                                <Style TargetType="TextBlock">
                                    <Style.Triggers>
                                        <DataTrigger Binding="{Binding Status}" Value="To Do">
                                            <Setter Property="Background" Value="#ffd700"/>
                                            <Setter Property="Foreground" Value="Black"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Refinement">
                                            <Setter Property="Background" Value="LightBlue"/>
                                            <Setter Property="Foreground" Value="Black"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="In Progress">
                                            <Setter Property="Background" Value="#0C9073"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Waiting for Deploy">
                                            <Setter Property="Background" Value="#726E6E"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="In Test">
                                            <Setter Property="Background" Value="#85C50E"/>
                                            <Setter Property="Foreground" Value="Black"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Test Succeeded">
                                            <Setter Property="Background" Value="#0C9073"/>
                                            <Setter Property="Foreground" Value="Yellow"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Test Failed">
                                            <Setter Property="Background" Value="Red"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Done">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Foreground" Value="Green"/>
                                            <Setter Property="FontWeight" Value="Bold"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="Canceled">
                                            <Setter Property="Background" Value="Gray"/>
                                            <Setter Property="Foreground" Value="White"/>
                                        </DataTrigger>
                                        <DataTrigger Binding="{Binding Status}" Value="On Hold">
                                            <Setter Property="Background" Value="#3B02F7"/>
                                            <Setter Property="Foreground" Value="#FBFF1C"/>
                                        </DataTrigger>
                                    </Style.Triggers>
                                </Style>
                            </TextBlock.Style>
                        </TextBlock>
                    </DataTemplate>
                </DataGridTemplateColumn.CellTemplate>
                <DataGridTemplateColumn.CellEditingTemplate>
                    <DataTemplate>
                        <ComboBox SelectedValue="{Binding Status, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" 
                                  SelectedValuePath="Content"
                                  VerticalAlignment="Center">
                            <ComboBoxItem Content="To Do"/>
                            <ComboBoxItem Content="Refinement"/>
                            <ComboBoxItem Content="In Progress"/>
                            <ComboBoxItem Content="Waiting for Deploy"/>
                            <ComboBoxItem Content="In Test"/>
                            <ComboBoxItem Content="Test Succeeded"/>
                            <ComboBoxItem Content="Test Failed"/>
                            <ComboBoxItem Content="Done"/>
                            <ComboBoxItem Content="Canceled"/>
                            <ComboBoxItem Content="On Hold"/>
                        </ComboBox>
                    </DataTemplate>
                </DataGridTemplateColumn.CellEditingTemplate>
            </DataGridTemplateColumn>
            
            <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="80" IsReadOnly="True">
                <DataGridTextColumn.ElementStyle>
                    <Style TargetType="TextBlock">
                        <Setter Property="VerticalAlignment" Value="Center"/>
                        <Setter Property="Padding" Value="4"/>
                    </Style>
                </DataGridTextColumn.ElementStyle>
            </DataGridTextColumn>
            
            <DataGridTextColumn Header="Priority" Binding="{Binding Priority}" Width="80" IsReadOnly="True">
                <DataGridTextColumn.ElementStyle>
                    <Style TargetType="TextBlock">
                        <Setter Property="VerticalAlignment" Value="Center"/>
                        <Setter Property="Padding" Value="4"/>
                    </Style>
                </DataGridTextColumn.ElementStyle>
            </DataGridTextColumn>
        </DataGrid.Columns>
    </DataGrid>
    </Grid>
</Window>
